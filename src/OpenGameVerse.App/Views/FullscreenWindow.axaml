<suki:SukiWindow xmlns="https://github.com/avaloniaui"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:vm="using:OpenGameVerse.App.ViewModels"
                 xmlns:conv="using:OpenGameVerse.App.Converters"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:suki="clr-namespace:SukiUI.Controls;assembly=SukiUI"
                 mc:Ignorable="d" d:DesignWidth="1920" d:DesignHeight="1080"
                 x:Class="OpenGameVerse.App.Views.FullscreenWindow"
                 x:DataType="vm:FullscreenViewModel"
                 Title="OpenGameVerse"
                 WindowState="FullScreen"
                 IsTitleBarVisible="False"
                 FontFamily="Inter"
                 FontSize="20">

    <suki:SukiWindow.Styles>
        <Style Selector="Button.nav-button">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorderLowBrush}" />
            <Setter Property="BorderThickness" Value="2" />
            <Setter Property="Padding" Value="20,10" />
            <Setter Property="Margin" Value="5" />
            <Setter Property="FontSize" Value="20" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>

        <Style Selector="Button.nav-button:pointerover">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeControlHighlightHighBrush}" />
        </Style>

        <Style Selector="Button.nav-button:focus">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccentBrush}" />
        </Style>

        <Style Selector="Border.game-tile">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorderLowBrush}" />
            <Setter Property="BorderThickness" Value="3" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Padding" Value="12" />
            <Setter Property="Margin" Value="15" />
            <Setter Property="Width" Value="280" />
            <Setter Property="Height" Value="400" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>

        <Style Selector="Border.game-tile:pointerover">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeControlHighlightMidBrush}" />
        </Style>

        <Style Selector="Border.game-tile:focus">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeAccentBrush}" />
            <Setter Property="BorderThickness" Value="4" />
        </Style>

        <Style Selector="Border.game-tile:focus Border#FocusRing">
            <Setter Property="Opacity" Value="1" />
        </Style>

        <Style Selector="Border.game-tile:focus TextBlock.launch-hint">
            <Setter Property="Opacity" Value="1" />
        </Style>
    </suki:SukiWindow.Styles>

    <suki:SukiMainHost>
        <Viewbox Stretch="Uniform" StretchDirection="Both">
            <Grid RowDefinitions="Auto,*,Auto" Margin="60,40">

                <Grid Grid.Row="0" ColumnDefinitions="*,Auto" Margin="0,0,0,30">
                    <StackPanel Orientation="Horizontal" Spacing="20">
                        <Image Source="/Assets/opengameverse-icon.png"
                               Width="48"
                               Height="48" />
                        <TextBlock Text="OpenGameVerse"
                                   FontSize="48"
                                   FontWeight="Bold"
                                   VerticalAlignment="Center" />
                        <TextBlock Text="{Binding TotalGames, StringFormat='({0} Games)'}"
                                   FontSize="28"
                                   VerticalAlignment="Center" />
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="15">
                        <Button Classes="nav-button"
                                Content="â†»"
                                ToolTip.Tip="Scan for games"
                                Command="{Binding ScanGamesCommand}"
                                IsEnabled="{Binding !IsScanning}" />
                        <Button Classes="nav-button"
                                Content="Exit Fullscreen"
                                Command="{Binding ExitFullscreenCommand}" />
                    </StackPanel>
                </Grid>

                <ScrollViewer Grid.Row="1"
                              HorizontalScrollBarVisibility="Disabled"
                              VerticalScrollBarVisibility="Auto">
                    <ItemsControl Name="GameGrid"
                                  ItemsSource="{Binding Games}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"
                                           HorizontalAlignment="Center" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>

                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Classes="game-tile"
                                        Focusable="True"
                                        DoubleTapped="OnGameDoubleTapped">
                                    <Border.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="Launch Game"
                                                      Command="{Binding $parent[Window].((vm:FullscreenViewModel)DataContext).LaunchGameCommand}"
                                                      CommandParameter="{Binding}" />
                                            <MenuItem Header="Stop Game"
                                                      Command="{Binding $parent[Window].((vm:FullscreenViewModel)DataContext).StopGameCommand}"
                                                      CommandParameter="{Binding}"
                                                      IsEnabled="{Binding IsRunning}" />
                                        </ContextMenu>
                                    </Border.ContextMenu>
                                    <Grid>
                                        <Border Name="FocusRing"
                                                BorderBrush="{DynamicResource ThemeAccentBrush}"
                                                BorderThickness="4"
                                                CornerRadius="14"
                                                Opacity="0"
                                                IsHitTestVisible="False" />
                                        <Grid RowDefinitions="*,Auto">
                                            <Border Grid.Row="0"

                                                    CornerRadius="8"
                                                    ClipToBounds="True"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                                <Panel>
                                                    <TextBlock Text="ðŸŽ®"
                                                               FontSize="120"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               IsVisible="{Binding CoverImagePath, Converter={x:Static ObjectConverters.IsNull}}" />

                                                    <Image
                                                        Source="{Binding CoverImagePath, Converter={x:Static conv:FilePathToBitmapConverter.Instance}}"
                                                        Stretch="Uniform"
                                                        MaxWidth="260"
                                                        MaxHeight="340"
                                                        IsVisible="{Binding CoverImagePath, Converter={x:Static ObjectConverters.IsNotNull}}" />
                                                </Panel>
                                            </Border>

                                            <StackPanel Grid.Row="1" Margin="0,15,0,0">
                                                <TextBlock Text="{Binding Title}"
                                                           FontSize="22"
                                                           FontWeight="SemiBold"
                                                           TextWrapping="Wrap"
                                                           MaxLines="2"
                                                           TextTrimming="CharacterEllipsis"
                                                           HorizontalAlignment="Center"
                                                           TextAlignment="Center" />

                                                <TextBlock Text="åŸ·è¡Œä¸­"
                                                           FontSize="14"
                                                           FontWeight="SemiBold"
                                                           Foreground="{DynamicResource ThemeAccentBrush}"
                                                           HorizontalAlignment="Center"
                                                           Margin="0,6,0,0"
                                                           IsVisible="{Binding IsRunning}" />

                                                <StackPanel Orientation="Horizontal"
                                                            HorizontalAlignment="Center"
                                                            Margin="0,8,0,0"
                                                            Spacing="10">
                                                    <TextBlock Text="{Binding Platform}"
                                                               FontSize="16"
                                                               FontWeight="Medium" />
                                                    <TextBlock Text="â€¢"
                                                               FontSize="16" />
                                                    <TextBlock Text="{Binding SizeDisplay}"
                                                               FontSize="16" />
                                                </StackPanel>

                                                <TextBlock Classes="launch-hint"
                                                           Text="Press A to Launch"
                                                           FontSize="16"
                                                           HorizontalAlignment="Center"
                                                           Margin="0,10,0,0"
                                                           Opacity="0" />
                                            </StackPanel>
                                        </Grid>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <Border Grid.Row="2"
                        BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                        BorderThickness="0,2,0,0"
                        CornerRadius="12"
                        Padding="20,15"
                        Margin="0,30,0,0">
                    <Grid ColumnDefinitions="*,Auto">
                        <TextBlock Text="{Binding StatusMessage}"
                                   FontSize="18"
                                   VerticalAlignment="Center" />
                        <StackPanel Grid.Column="1"
                                    Orientation="Horizontal"
                                    Spacing="15"
                                    VerticalAlignment="Center">
                            <TextBlock Text="Controller: D-Pad/Stick Move â€¢ A Launch â€¢ B Exit"
                                       FontSize="16" />
                            <ProgressBar IsIndeterminate="True"
                                         IsVisible="{Binding IsScanning}"
                                         Width="200"
                                         Height="4" />
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Viewbox>
    </suki:SukiMainHost>
</suki:SukiWindow>
